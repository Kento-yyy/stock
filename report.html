
    <html>
      <head>
        <meta charset='utf-8' />
        
    <style>
      body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans JP', 'Apple Color Emoji', 'Segoe UI Emoji', sans-serif; }
      table { border-collapse: collapse; width: 100%; max-width: 100%; table-layout: fixed; }
      th, td { border: 1px solid #ddd; padding: 8px 10px; white-space: nowrap; }
      th { background: #f5f5f5; text-align: right; user-select: none; }
      th:first-child, td:first-child { text-align: left; }
      td { text-align: right; }
      tfoot td { font-weight: bold; background: #fafafa; }
      .muted { color: #666; font-size: 12px; }
      .sortable { cursor: pointer; }
      .sort-indicator { margin-left: 6px; color: #888; font-size: 11px; }
      .toolbar { display:flex; align-items:center; flex-wrap: wrap; gap:10px; margin: 8px 0 14px; }
      .toolbar input[type=range]{ width: 280px; }
      .toolbar select { padding: 4px 6px; }
      .toolbar .label { font-weight: 600; }
      .chg { color:#666; font-size:12px; margin-left:4px; white-space:nowrap; }
      .chg .up { color:#0a0; }
      .chg .down { color:#c00; }
      .up { color:#0a0; }
      .down { color:#c00; }
      .table-wrap { overflow-x: auto; }
      .co { color:#444; font-size:12px; margin-left:6px; }
    </style>
    
        
    <script>
    (function(){
      
      function fmtUSD(n){ return (isNaN(n) ? '' : n.toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2})); }
      function fmtJPY(n){ return (isNaN(n) ? '' : Math.round(n).toLocaleString()); }
      function getCellValue(cell, type){
        var dv = cell.getAttribute('data-value');
        if (type === 'num'){
          var v = (dv !== null ? dv : (cell.textContent || '').replace(/,/g,''));
          var n = parseFloat(v);
          return isNaN(n) ? NaN : n;
        } else {
          return (dv !== null ? dv : (cell.textContent || '')).trim().toUpperCase();
        }
      }
      function sortTableEl(table, colIndex, asc){
        if(!table) return;
        var tbody = table.tBodies[0];
        if(!tbody) return;
        var rows = Array.prototype.slice.call(tbody.querySelectorAll('tr'));
        if(!rows.length) return;
        var ths = table.tHead && table.tHead.rows.length ? table.tHead.rows[0].cells : null;
        var type = (ths && ths[colIndex] && ths[colIndex].getAttribute('data-sort')) || (colIndex === 0 ? 'str' : 'num');
        rows.sort(function(a,b){
          var av = getCellValue(a.cells[colIndex], type);
          var bv = getCellValue(b.cells[colIndex], type);
          if (type === 'num'){
            var aNaN = !(isFinite(av));
            var bNaN = !(isFinite(bv));
            if (aNaN && bNaN) return 0;
            if (aNaN) return 1; // NaN to bottom
            if (bNaN) return -1;
            return asc ? (av - bv) : (bv - av);
          } else {
            return asc ? (String(av).localeCompare(String(bv))) : (String(bv).localeCompare(String(av)));
          }
        });
        rows.forEach(function(r){ tbody.appendChild(r); });
        // update indicators
        var ths2 = table.tHead.rows[0].cells;
        for (var i=0;i<ths2.length;i++){
          var span = ths2[i].querySelector('.sort-indicator');
          if(span) span.textContent = '';
          else { var sp = document.createElement('span'); sp.className = 'sort-indicator'; ths2[i].appendChild(sp); }
        }
        var active = ths2[colIndex].querySelector('.sort-indicator');
        if(active) active.textContent = asc ? '▲' : '▼';
      }
      function sortTable(tableId, colIndex, asc){
        var table = document.getElementById(tableId);
        if(!table) return;
        sortTableEl(table, colIndex, asc);
      }
      window.attachSortHandlers = function(){
        var tables = document.querySelectorAll('table.pf-table');
        if(!tables || !tables.length) return;
        tables.forEach(function(table){
          var thead = table.tHead;
          if (!thead || !thead.rows.length) return;
          var ths = thead.rows[0].cells;
          for (var i=0;i<ths.length;i++){
            var th = ths[i];
            th.classList.add('sortable');
            // 明示的に型を指定（0列目は文字列、それ以外は数値）
            th.setAttribute('data-sort', i === 0 ? 'str' : 'num');
          }
          thead.addEventListener('click', function(ev){
            var th = ev.target && ev.target.closest ? ev.target.closest('th') : null;
            if (!th || !thead.contains(th)) return;
            var idx = Array.prototype.indexOf.call(ths, th);
            if (idx == null || idx < 0) return;
            var asc = th.getAttribute('data-asc') !== 'true';
            Array.prototype.forEach.call(ths, function(h){ h.removeAttribute('data-asc'); var s=h.querySelector('.sort-indicator'); if(s) s.textContent=''; });
            th.setAttribute('data-asc', asc ? 'true' : 'false');
            sortTableEl(table, idx, asc);
          });
        });
      };
      function parseCSV(text){ return null; }
      function initMonthly(){}
      document.addEventListener('DOMContentLoaded', function(){
        if (window.attachSortHandlers) window.attachSortHandlers();
        // Initial sort: JPY_VALUE (col 5) descending for both tables when monthly view is not used
        try{
          var tables = document.querySelectorAll('table.pf-table');
          tables.forEach(function(t){
            var hasBody = t && t.tBodies && t.tBodies.length && t.tBodies[0] && t.tBodies[0].rows && t.tBodies[0].rows.length;
            if (hasBody && t.querySelectorAll('tbody.month-body').length === 0){
              // Clear existing indicators on initial, set desc on JPY_VALUE
              var ths = t.tHead && t.tHead.rows.length ? t.tHead.rows[0].cells : null;
              if (ths && ths.length > 12){
                for (var i=0;i<ths.length;i++){ var s = ths[i].querySelector('.sort-indicator'); if(s) s.textContent=''; ths[i].removeAttribute('data-asc'); }
                ths[12].setAttribute('data-asc','false');
              }
              sortTableEl(t, 12, false); // JPY_VALUE desc with new indices (PER added)
            }
          });
        } catch(e){}
        initMonthly();
      });
    })();
    </script>
    <script>
    (function(){
      
      function nowStr(){
        var d = new Date();
        var pad = (n)=> String(n).padStart(2,'0');
        return d.getFullYear()+"-"+pad(d.getMonth()+1)+"-"+pad(d.getDate())+" "+pad(d.getHours())+":"+pad(d.getMinutes());
      }
      function timeStr(ts){
        try{
          var d = new Date(ts);
          var pad = (n)=> String(n).padStart(2,'0');
          return d.getFullYear()+"-"+pad(d.getMonth()+1)+"-"+pad(d.getDate())+" "+pad(d.getHours())+":"+pad(d.getMinutes());
        }catch(e){ return nowStr(); }
      }
      function guessIsJPY(sym){ return /\.T$/i.test(sym || ''); }
      function numberFromCell(td){ if(!td) return NaN; var dv=td.getAttribute('data-value'); if(dv!=null) return parseFloat(dv); var t=(td.textContent||'').replace(/,/g,''); var n=parseFloat(t); return isNaN(n)?NaN:n; }
      function setNumCell(td, n, fmt, decimals){ if(!td) return; var val = (isFinite(n)? n : NaN); td.setAttribute('data-value', isFinite(val)? String(val): ''); if(!isFinite(val)){ td.textContent=''; return; } if(fmt==='JPY'){ td.textContent = Math.round(val).toLocaleString(); } else { td.textContent = val.toLocaleString(undefined,{minimumFractionDigits:decimals||2, maximumFractionDigits:decimals||2}); } }
      function headerIndexMap(table){
        var map = {};
        if(!table || !table.tHead || !table.tHead.rows.length) return map;
        var ths = table.tHead.rows[0].cells;
        for (var i=0;i<ths.length;i++){
          var txt = (ths[i].textContent||'').toUpperCase().replace(/[\s▲▼]/g,'');
          map[txt] = i;
        }
        return map;
      }
      // Tag columns and cells with data-col for stable addressing regardless of index shifts
      function tagTableColumns(table){
        if(!table || !table.tHead || !table.tHead.rows.length) return;
        var keys = ['SYMBOL','SHARES','USD_PRICE','USD_VALUE','JPY_PRICE','JPY_VALUE'];
        var ths = table.tHead.rows[0].cells;
        var colKey = new Array(ths.length);
        for (var i=0;i<ths.length;i++){
          var txt = (ths[i].textContent||'').toUpperCase().replace(/[\s▲▼]/g,'');
          if (keys.indexOf(txt) >= 0){ ths[i].setAttribute('data-col', txt); colKey[i] = txt; }
        }
        // Disambiguate YoY/MoM/DoD for USD and JPY blocks based on position after *_PRICE
        var norm = [];
        for (var i=0;i<ths.length;i++){ norm[i] = (ths[i].textContent||'').toUpperCase().replace(/[\s▲▼]/g,''); }
        var idxUsdP = norm.indexOf('USD_PRICE');
        if (idxUsdP >= 0){
          if (ths[idxUsdP+1]) { ths[idxUsdP+1].setAttribute('data-col','USD_YOY'); colKey[idxUsdP+1] = 'USD_YOY'; }
          if (ths[idxUsdP+2]) { ths[idxUsdP+2].setAttribute('data-col','USD_MOM'); colKey[idxUsdP+2] = 'USD_MOM'; }
          if (ths[idxUsdP+3]) { ths[idxUsdP+3].setAttribute('data-col','USD_DOD'); colKey[idxUsdP+3] = 'USD_DOD'; }
        }
        var idxJpyP = norm.indexOf('JPY_PRICE');
        if (idxJpyP >= 0){
          if (ths[idxJpyP+1]) { ths[idxJpyP+1].setAttribute('data-col','JPY_YOY'); colKey[idxJpyP+1] = 'JPY_YOY'; }
          if (ths[idxJpyP+2]) { ths[idxJpyP+2].setAttribute('data-col','JPY_MOM'); colKey[idxJpyP+2] = 'JPY_MOM'; }
          if (ths[idxJpyP+3]) { ths[idxJpyP+3].setAttribute('data-col','JPY_DOD'); colKey[idxJpyP+3] = 'JPY_DOD'; }
        }
        function tagRow(row){
          if(!row) return;
          for (var i=0;i<row.cells.length;i++){
            var key = colKey[i];
            if (key) row.cells[i].setAttribute('data-col', key);
          }
        }
        var tb = table.tBodies && table.tBodies[0]; if (tb){ Array.prototype.forEach.call(tb.rows, tagRow); }
        var tf = table.tFoot && table.tFoot.rows && table.tFoot.rows[0]; if (tf) tagRow(tf);
      }
      function getCellByKey(row, key){ return row ? row.querySelector('td[data-col="'+key+'"]') : null; }
      function setPctCell(td, frac){
        if (!td) return;
        if (!isFinite(frac)) { td.setAttribute('data-value',''); td.textContent=''; return; }
        var cls = frac >= 0 ? 'up' : 'down';
        var pct = (frac*100).toFixed(1);
        td.setAttribute('data-value', String(frac));
        td.innerHTML = "<span class='chg'><span class='"+cls+"'>" + (frac>=0?'+':'') + pct + "%</span></span>";
      }
      // Optional proxy endpoint (Cloudflare Workers). Use query param ?api=https://<your-worker>/quote
      function getApiBase(){
        try{
          var p = new URLSearchParams(location.search).get('api');
          if (p) return p.replace(/\/$/, '');
          var ls = localStorage.getItem('PF_API_BASE');
          if (ls) return ls.replace(/\/$/, '');
        }catch(e){}
        return null;
      }
      // Persist and restore last successful quotes in localStorage
      function loadCachedQuotes(){
        try{
          var s = localStorage.getItem('PF_LAST_QUOTES');
          if(!s) return null;
          var j = JSON.parse(s);
          if (j && j.quotes && typeof j.t === 'number') return j;
        }catch(e){}
        return null;
      }
      function saveCachedQuotes(quotes){
        try{
          if (quotes && Object.keys(quotes).length){
            localStorage.setItem('PF_LAST_QUOTES', JSON.stringify({ t: Date.now(), quotes: quotes }));
          }
        }catch(e){}
      }
      var __pfAppliedCache = false;
      var __pfCachedAt = 0;
      async function fetchViaProxy(symbols){
        var base = getApiBase();
        if(!base) throw new Error('no api');
        var qs = encodeURIComponent(symbols.join(','));
        var sep = base.includes('?') ? '&' : '?';
        // Prefer Stooq at the worker, and let it fill missing via Yahoo
        var url1 = base + sep + 'symbols=' + qs + '&prefer=stooq';
        
        var res1 = await fetch(url1, {cache:'no-store'});
        if (res1.ok) {
          try {
            var j1 = await res1.json();
            var out1 = (j1 && j1.quotes) || {};
            if (Object.keys(out1).length) return out1;
          } catch(_) {}
        }
        // Fallback to 's=' query param
        var url2 = base + sep + 's=' + qs + '&prefer=stooq';
        
        var res2 = await fetch(url2, {cache:'no-store'});
        if(!res2.ok) throw new Error('proxy HTTP '+res2.status);
        var j2 = await res2.json();
        var out2 = (j2 && j2.quotes) || {};
        return out2;
      }
      async function fetchViaProxyOne(sym){
        // Fetch a single symbol (plus USDJPY) to avoid batch mix-ups
        var syms = [sym];
        try { if (sym !== 'USDJPY=X') syms.push('USDJPY=X'); } catch(e) {}
        var q = await fetchViaProxy(syms);
        return q || {};
      }
      async function fetchYahoo(symbols){
        if(!symbols || !symbols.length) return {};
        var url = 'https://query1.finance.yahoo.com/v7/finance/quote?symbols=' + encodeURIComponent(symbols.join(','));
        var res = await fetch(url, {cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        var j = await res.json();
        var arr = (j && j.quoteResponse && j.quoteResponse.result) || [];
        var out = {};
        arr.forEach(function(r){ if(r && r.symbol){ out[String(r.symbol).toUpperCase()] = r; } });
        return out;
      }
      function mapToStooqSymbols(symbols){
        var map = {}; // stooqSym -> originalSym
        symbols.forEach(function(sym){
          var s = String(sym).toUpperCase();
          if (s === 'USDJPY=X') { map['usdjpy'] = s; return; }
          if (/\.T$/.test(s)) { map[s.replace(/\.T$/,'').toLowerCase()+'.jp'] = s; return; }
          // default to US
          map[s.toLowerCase()+'.us'] = s;
        });
        return map; // keys are stooq symbols
      }
      function parseStooqCSV(text){
        // Expect header like: Symbol,Date,Time,Open,High,Low,Close,Volume
        var out = {};
        if(!text) return out;
        var lines = text.trim().split(/\r?\n/);
        lines.shift();
        lines.forEach(function(line){
          if(!line) return;
          var cols = line.split(',');
          var sym = cols[0];
          var close = parseFloat(cols[6]);
          if (sym && isFinite(close)){
            out[sym.toLowerCase()] = { regularMarketPrice: close };
          }
        });
        return out;
      }
      async function fetchStooq(symbols){
        if(!symbols || !symbols.length) return {};
        var m = mapToStooqSymbols(symbols);
        var stooqSyms = Object.keys(m);
        var url = 'https://stooq.com/q/l/?s=' + encodeURIComponent(stooqSyms.join(',')) + '&f=sd2t2ohlcv&h&e=csv';
        var res = await fetch(url, {cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        var txt = await res.text();
        var parsed = parseStooqCSV(txt);
        var out = {};
        Object.keys(parsed).forEach(function(stooqSym){
          var orig = m[stooqSym];
          if (orig) out[orig] = parsed[stooqSym];
        });
        return out;
      }
      function updateTables(quotes){
        var tables = document.querySelectorAll('table.pf-table');
        var totalUsdAll = 0, totalJpyAll = 0;
        var title = document.querySelector('#pf-title, body > h2');
        if(title){ var t = (title.textContent||''); title.textContent = t.replace(/\(.*?\)/, '('+nowStr()+')'); }
        var last = document.getElementById('pf-last-updated'); if(last){ last.textContent = '最終更新: '+nowStr(); }
        var usdJpy = quotes['USDJPY=X'] && quotes['USDJPY=X'].regularMarketPrice;
        // Normalize USDJPY: if rate looks inverted (e.g., 0.0067), flip it
        if (isFinite(usdJpy) && usdJpy > 0 && usdJpy < 1) {
          usdJpy = 1 / usdJpy;
        }
        
        tables.forEach(function(table){
          try { tagTableColumns(table); } catch(e){}
          var idx = headerIndexMap(table);
          
          var colSym = idx['SYMBOL'];
          var colShares = idx['SHARES'];
          var colUsdP = idx['USD_PRICE'];
          var colUsdV = idx['USD_VALUE'];
          var colJpyP = idx['JPY_PRICE'];
          var colJpyV = idx['JPY_VALUE'];
          if(colSym==null || colShares==null) return;
          var rows = table.tBodies[0] ? Array.prototype.slice.call(table.tBodies[0].rows) : [];
          var sumUsd = 0, sumJpy = 0;
          rows.forEach(function(tr){
            var sym = (tr.getAttribute('data-symbol') || '').trim();
            if(!sym) return;
            var isJPY = guessIsJPY(sym);
            var shares = numberFromCell(getCellByKey(tr,'SHARES') || tr.cells[colShares]);
            var q = quotes[sym.toUpperCase()];
            var priceUsd, priceJpy;
            // Strict: use server-provided JPY when available. For .T, do not fall back to rmp.
            if (q) {
              if (isFinite(q.jpy)) {
                priceJpy = Number(q.jpy);
                if (isFinite(usdJpy)) priceUsd = priceJpy / usdJpy;
              } else if (!isJPY) {
                // Non-JP symbols: derive from currency + rmp
                if (isFinite(q.regularMarketPrice)) {
                  var cur = (q.currency || '').toUpperCase();
                  if (cur === 'JPY') {
                    priceJpy = q.regularMarketPrice;
                    if (isFinite(usdJpy)) priceUsd = priceJpy / usdJpy;
                  } else { // default USD
                    priceUsd = q.regularMarketPrice;
                    if (isFinite(usdJpy)) priceJpy = priceUsd * usdJpy;
                  }
                }
              }
            }
            
            var cellUsdP = getCellByKey(tr,'USD_PRICE') || tr.cells[colUsdP];
            var cellUsdV = getCellByKey(tr,'USD_VALUE') || tr.cells[colUsdV];
            var cellJpyP = getCellByKey(tr,'JPY_PRICE') || tr.cells[colJpyP];
            var cellJpyV = getCellByKey(tr,'JPY_VALUE') || tr.cells[colJpyV];
            var cellUsdYoY = getCellByKey(tr,'USD_YOY');
            var cellUsdMoM = getCellByKey(tr,'USD_MOM');
            var cellUsdDoD = getCellByKey(tr,'USD_DOD');
            var cellJpyYoY = getCellByKey(tr,'JPY_YOY');
            var cellJpyMoM = getCellByKey(tr,'JPY_MOM');
            var cellJpyDoD = getCellByKey(tr,'JPY_DOD');
            if (isFinite(priceUsd)){
              if(cellUsdP) setNumCell(cellUsdP, priceUsd, 'USD', 2);
              if(cellUsdV) setNumCell(cellUsdV, shares*priceUsd, 'USD', 2);
            }
            if (isFinite(priceJpy)){
              if(cellJpyP) setNumCell(cellJpyP, priceJpy, 'JPY');
              if(cellJpyV) setNumCell(cellJpyV, shares*priceJpy, 'JPY');
            }
            // Percent changes (prefer API-provided; fallback to local computation)
            // USD block
            if (isFinite(priceUsd)){
              var usdDoD = q && q.usdDoD;
              var usdMoM = q && q.usdMoM;
              var usdYoY = q && q.usdYoY;
              if (!(isFinite(usdDoD))) {
                var prevUsd1 = undefined;
                if (q) {
                  if ((q.currency||'').toUpperCase()==='USD'){
                    prevUsd1 = q.prevClose;
                  } else if (isFinite(usdJpy) && isFinite(q.prevJpy)) {
                    prevUsd1 = q.prevJpy / usdJpy;
                  }
                }
                if (isFinite(prevUsd1) && prevUsd1>0) usdDoD = (priceUsd - prevUsd1)/prevUsd1;
              }
              if (!(isFinite(usdMoM))) {
                var prevUsd30 = undefined;
                if (q) {
                  if ((q.currency||'').toUpperCase()==='USD'){
                    prevUsd30 = q.prevClose30d;
                  } else if (isFinite(usdJpy) && isFinite(q.prevJpy30d)) {
                    prevUsd30 = q.prevJpy30d / usdJpy;
                  }
                }
                if (isFinite(prevUsd30) && prevUsd30>0) usdMoM = (priceUsd - prevUsd30)/prevUsd30;
              }
              if (!(isFinite(usdYoY))) {
                var prevUsd365 = undefined;
                if (q) {
                  if ((q.currency||'').toUpperCase()==='USD'){
                    prevUsd365 = q.prevClose365d;
                  } else if (isFinite(usdJpy) && isFinite(q.prevJpy365d)) {
                    prevUsd365 = q.prevJpy365d / usdJpy;
                  }
                }
                if (isFinite(prevUsd365) && prevUsd365>0) usdYoY = (priceUsd - prevUsd365)/prevUsd365;
              }
              if (cellUsdDoD && isFinite(usdDoD)) setPctCell(cellUsdDoD, usdDoD);
              if (cellUsdMoM && isFinite(usdMoM)) setPctCell(cellUsdMoM, usdMoM);
              if (cellUsdYoY && isFinite(usdYoY)) setPctCell(cellUsdYoY, usdYoY);
            }
            // JPY block
            if (isFinite(priceJpy)){
              var jpyDoD = q && q.jpyDoD;
              var jpyMoM = q && q.jpyMoM;
              var jpyYoY = q && q.jpyYoY;
              if (!(isFinite(jpyDoD))) {
                var prevJ1 = q && (q.prevJpy);
                if (!isFinite(prevJ1) && q && ((q.currency||'').toUpperCase()==='JPY' || /\.T$/i.test(sym))) prevJ1 = q.prevClose;
                if (isFinite(prevJ1) && prevJ1>0) jpyDoD = (priceJpy - prevJ1)/prevJ1;
              }
              if (!(isFinite(jpyMoM))) {
                var prevJ30 = q && (q.prevJpy30d);
                if (!isFinite(prevJ30) && q && ((q.currency||'').toUpperCase()==='JPY' || /\.T$/i.test(sym))) prevJ30 = q.prevClose30d;
                if (isFinite(prevJ30) && prevJ30>0) jpyMoM = (priceJpy - prevJ30)/prevJ30;
              }
              if (!(isFinite(jpyYoY))) {
                var prevJ365 = q && (q.prevJpy365d);
                if (!isFinite(prevJ365) && q && ((q.currency||'').toUpperCase()==='JPY' || /\.T$/i.test(sym))) prevJ365 = q.prevClose365d;
                if (isFinite(prevJ365) && prevJ365>0) jpyYoY = (priceJpy - prevJ365)/prevJ365;
              }
              if (cellJpyDoD && isFinite(jpyDoD)) setPctCell(cellJpyDoD, jpyDoD);
              if (cellJpyMoM && isFinite(jpyMoM)) setPctCell(cellJpyMoM, jpyMoM);
              if (cellJpyYoY && isFinite(jpyYoY)) setPctCell(cellJpyYoY, jpyYoY);
            }
            if(cellUsdV){ var v = numberFromCell(cellUsdV); if(isFinite(v)) sumUsd += v; }
            if(cellJpyV){ var w = numberFromCell(cellJpyV); if(isFinite(w)) sumJpy += w; }
          });
          // update tfoot totals if present
          if(table.tFoot && table.tFoot.rows.length){
            var tfr = table.tFoot.rows[0];
            var tfUsd = (tfr && (tfr.querySelector('td[data-col="USD_VALUE"]') || tfr.cells[colUsdV])) || null;
            var tfJpy = (tfr && (tfr.querySelector('td[data-col="JPY_VALUE"]') || tfr.cells[colJpyV])) || null;
            if(tfUsd) setNumCell(tfUsd, sumUsd, 'USD', 2);
            if(tfJpy) setNumCell(tfJpy, sumJpy, 'JPY');
          }
          // accumulate global totals (skip tables without rows)
          if (rows && rows.length) {
            if (isFinite(sumUsd)) totalUsdAll += sumUsd;
            if (isFinite(sumJpy)) totalJpyAll += sumJpy;
          }
          // re-apply sort if a header has data-asc state
          try{
            var thead = table.tHead; if(thead && thead.rows.length){
              var ths = thead.rows[0].cells;
              for(var i=0;i<ths.length;i++){
                var ascAttr = ths[i].getAttribute('data-asc');
                if(ascAttr === 'true' || ascAttr === 'false'){
                  var asc = (ascAttr === 'true');
                  if (typeof sortTableEl === 'function') sortTableEl(table, i, asc);
                  break; // apply first active sort
                }
              }
            }
          } catch(e){}
        });
        // Update overall totals table (pf-total) if exists
        try{
          var tot = document.getElementById('pf-total');
          if (tot && tot.tFoot && tot.tFoot.rows.length){
            var tfr2 = tot.tFoot.rows[0];
            var tfUsd2 = tfr2 && (tfr2.querySelector('td[data-col="USD_VALUE"]'));
            var tfJpy2 = tfr2 && (tfr2.querySelector('td[data-col="JPY_VALUE"]'));
            var idx2 = headerIndexMap(tot);
            if (!tfUsd2 && idx2['USD_VALUE']!=null) tfUsd2 = tfr2.cells[idx2['USD_VALUE']];
            if (!tfJpy2 && idx2['JPY_VALUE']!=null) tfJpy2 = tfr2.cells[idx2['JPY_VALUE']];
            if (tfUsd2) setNumCell(tfUsd2, totalUsdAll, 'USD', 2);
            if (tfJpy2) setNumCell(tfJpy2, totalJpyAll, 'JPY');
          }
        } catch(e){}
      }
      var __pfRefreshing = false;
      async function refresh(){
        if (__pfRefreshing) return; // avoid overlapping refreshes
        __pfRefreshing = true;
        var btn = document.getElementById('pf-refresh-btn'); if(btn){ btn.disabled = true; btn.textContent='更新中…'; }
        try{
          var syms = [];
          document.querySelectorAll('table.pf-table tbody tr[data-symbol]').forEach(function(tr){ var s=tr.getAttribute('data-symbol'); if(s) syms.push(s); });
          syms = Array.from(new Set(syms.map(function(s){return s.toUpperCase();})));
          if(syms.indexOf('USDJPY=X')<0) syms.push('USDJPY=X');
          var quotes = {};
          var apiBase = getApiBase();
          
          if (apiBase) {
            // When explicit API is specified, honor it and prefer Stooq at the worker
            try { quotes = await fetchViaProxy(syms); } catch(e) { }
            // Fast path: only re-fetch suspicious JP rows (rare) concurrently
            try {
              var codes = new Set(syms.filter(function(s){return /\.T$/i.test(s);}).map(function(s){return parseInt(s,10);}));
              var suspects = syms.filter(function(s){
                if(!/\.T$/i.test(s)) return false;
                var q = quotes[s]; if(!q) return true; // missing
                if (!isFinite(q.jpy)) return true;     // no JPY value
                var pj = Math.round(Number(q.jpy));
                var code = parseInt(s,10);
                // suspicious if equals another JP code (e.g., 7203) that's not own code
                return Number.isInteger(pj) && codes.has(pj) && pj !== code;
              });
              if (suspects.length){
                await Promise.all(suspects.map(async function(sym){
                  try{
                    var over = await fetchViaProxyOne(sym);
                    if (over && over[sym.toUpperCase()]) quotes[sym.toUpperCase()] = over[sym.toUpperCase()];
                  }catch(_){ }
                }));
              }
            } catch(_){ }
          } else {
            // Prefer Stooq directly, then Yahoo as fallback (no API)
            try { quotes = await fetchStooq(syms); } catch(e) { }
            if (!Object.keys(quotes).length) {
              try { quotes = await fetchYahoo(syms); } catch(e2) { }
            }
          }
          
          if (Object.keys(quotes).length === 0) throw new Error('no data');
          updateTables(quotes);
          saveCachedQuotes(quotes);
        } catch(e) {
          // On failure, show cached quotes if available
          var cached = loadCachedQuotes();
          if (cached && cached.quotes && Object.keys(cached.quotes).length){
            updateTables(cached.quotes);
            var last = document.getElementById('pf-last-updated'); if(last){ last.textContent = '最終更新: '+timeStr(cached.t)+'（キャッシュ）'; }
          } else {
            var last2 = document.getElementById('pf-last-updated'); if(last2){ last2.textContent = '更新失敗（ネットワーク/CORS）'; }
          }
        } finally {
          __pfRefreshing = false;
          if(btn){ btn.disabled = false; btn.textContent='更新'; }
        }
      }
      function readyRefresh(){
        var btn = document.getElementById('pf-refresh-btn'); if(btn){ btn.addEventListener('click', refresh); }
        // auto refresh on load and when back online/visible
        // Apply cached quotes first (if any), then refresh network
        try{
          var cached = loadCachedQuotes();
          if (cached && cached.quotes && Object.keys(cached.quotes).length){
            __pfAppliedCache = true; __pfCachedAt = cached.t;
            updateTables(cached.quotes);
            var last = document.getElementById('pf-last-updated'); if(last){ last.textContent = '最終更新: '+timeStr(cached.t)+'（キャッシュ）'; }
          }
        }catch(e){}
        refresh();
        window.addEventListener('online', refresh);
        document.addEventListener('visibilitychange', function(){ if(document.visibilityState==='visible') refresh(); });
      }
      if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', readyRefresh); else readyRefresh();
    })();
    </script>
    
      </head>
      <body>
        <h2>ポートフォリオ評価額 (2025-08-28 20:11)  (USD/JPY 表示)</h2>
        <div class='toolbar' id='pf-toolbar'>
          <button id='pf-refresh-btn'>更新</button>
          <span class='muted' id='pf-last-updated'></span>
        </div>
        
        
        <h3>国内株</h3>
        <div class='table-wrap'>
        <table id='pf-table-jpy' class='pf-table'>
          <colgroup><col style='width:22%'/><col style='width:6%'/><col style='width:6%'/><col style='width:8%'/><col style='width:5%'/><col style='width:5%'/><col style='width:5%'/><col style='width:10%'/><col style='width:8%'/><col style='width:5%'/><col style='width:5%'/><col style='width:5%'/><col style='width:10%'/></colgroup>
          <thead>
            <tr>
              <th style='text-align:left'>SYMBOL<span class='sort-indicator'></span></th>
              <th>SHARES<span class='sort-indicator'></span></th>
              <th>PER<span class='sort-indicator'></span></th>
              <th>USD_PRICE<span class='sort-indicator'></span></th>
              <th>YoY<span class='sort-indicator'></span></th>
              <th>MoM<span class='sort-indicator'></span></th>
              <th>DoD<span class='sort-indicator'></span></th>
              <th>USD_VALUE<span class='sort-indicator'></span></th>
              <th>JPY_PRICE<span class='sort-indicator'></span></th>
              <th>YoY<span class='sort-indicator'></span></th>
              <th>MoM<span class='sort-indicator'></span></th>
              <th>DoD<span class='sort-indicator'></span></th>
              <th>JPY_VALUE<span class='sort-indicator'></span></th>
            </tr>
          </thead>
          <tbody><tr data-symbol='8306.T'><td style='text-align:left' data-value='8306.T'>8306.T <span class='co'>MITSUBISHI UFJ FINANCIAL GROUP </span></td><td data-value='500.000000'>500</td><td data-value='14.217192'>14.2</td><td data-value='15.429474'>15.43</td><td data-value='0.528491'><span class='chg'><span class='up'>+52.8%</span></span></td><td data-value='0.090964'><span class='chg'><span class='up'>+9.1%</span></span></td><td data-value='0.009251'><span class='chg'><span class='up'>+0.9%</span></span></td><td data-value='7714.736783'>7,714.74</td><td data-value='2267.500000'>2,268</td><td data-value='0.536952'><span class='chg'><span class='up'>+53.7%</span></span></td><td data-value='0.074390'><span class='chg'><span class='up'>+7.4%</span></span></td><td data-value='0.007106'><span class='chg'><span class='up'>+0.7%</span></span></td><td data-value='1133750.000000'>1,133,750</td></tr><tr data-symbol='9201.T'><td style='text-align:left' data-value='9201.T'>9201.T <span class='co'>JAPAN AIRLINES CO LTD</span></td><td data-value='300.000000'>300</td><td data-value='12.892953'>12.9</td><td data-value='21.488987'>21.49</td><td data-value='0.322201'><span class='chg'><span class='up'>+32.2%</span></span></td><td data-value='0.065708'><span class='chg'><span class='up'>+6.6%</span></span></td><td data-value='-0.006053'><span class='chg'><span class='down'>-0.6%</span></span></td><td data-value='6446.696033'>6,446.70</td><td data-value='3158.000000'>3,158</td><td data-value='0.329520'><span class='chg'><span class='up'>+33.0%</span></span></td><td data-value='0.049518'><span class='chg'><span class='up'>+5.0%</span></span></td><td data-value='-0.008166'><span class='chg'><span class='down'>-0.8%</span></span></td><td data-value='947400.000000'>947,400</td></tr><tr data-symbol='8985.T'><td style='text-align:left' data-value='8985.T'>8985.T <span class='co'>JAPAN HOTEL REIT INVESTMENT COR</span></td><td data-value='11.000000'>11</td><td data-value='19.142770'>19.1</td><td data-value='583.836310'>583.84</td><td data-value='0.205399'><span class='chg'><span class='up'>+20.5%</span></span></td><td data-value='0.050948'><span class='chg'><span class='up'>+5.1%</span></span></td><td data-value='0.003299'><span class='chg'><span class='up'>+0.3%</span></span></td><td data-value='6422.199405'>6,422.20</td><td data-value='85800.000000'>85,800</td><td data-value='0.212071'><span class='chg'><span class='up'>+21.2%</span></span></td><td data-value='0.034982'><span class='chg'><span class='up'>+3.5%</span></span></td><td data-value='0.001167'><span class='chg'><span class='up'>+0.1%</span></span></td><td data-value='943800.000000'>943,800</td></tr><tr data-symbol='7203.T'><td style='text-align:left' data-value='7203.T'>7203.T <span class='co'>TOYOTA MOTOR CORP</span></td><td data-value='300.000000'>300</td><td data-value='8.981262'>9.0</td><td data-value='19.862683'>19.86</td><td data-value='0.086853'><span class='chg'><span class='up'>+8.7%</span></span></td><td data-value='0.099213'><span class='chg'><span class='up'>+9.9%</span></span></td><td data-value='0.008174'><span class='chg'><span class='up'>+0.8%</span></span></td><td data-value='5958.804852'>5,958.80</td><td data-value='2919.000000'>2,919</td><td data-value='0.092869'><span class='chg'><span class='up'>+9.3%</span></span></td><td data-value='0.082514'><span class='chg'><span class='up'>+8.3%</span></span></td><td data-value='0.006031'><span class='chg'><span class='up'>+0.6%</span></span></td><td data-value='875700.000000'>875,700</td></tr><tr data-symbol='8963.T'><td style='text-align:left' data-value='8963.T'>8963.T <span class='co'>INVINCIBLE INVESTMENT CORP</span></td><td data-value='10.000000'>10</td><td data-value='17.207018'>17.2</td><td data-value='455.909472'>455.91</td><td data-value='0.095110'><span class='chg'><span class='up'>+9.5%</span></span></td><td data-value='0.012404'><span class='chg'><span class='up'>+1.2%</span></span></td><td data-value='-0.005293'><span class='chg'><span class='down'>-0.5%</span></span></td><td data-value='4559.094725'>4,559.09</td><td data-value='67000.000000'>67,000</td><td data-value='0.101172'><span class='chg'><span class='up'>+10.1%</span></span></td><td data-value='-0.002976'><span class='chg'><span class='down'>-0.3%</span></span></td><td data-value='-0.007407'><span class='chg'><span class='down'>-0.7%</span></span></td><td data-value='670000.000000'>670,000</td></tr><tr data-symbol='9202.T'><td style='text-align:left' data-value='9202.T'>9202.T <span class='co'>ANA HOLDINGS INC</span></td><td data-value='200.000000'>200</td><td data-value='10.266198'>10.3</td><td data-value='20.311788'>20.31</td><td data-value='0.029105'><span class='chg'><span class='up'>+2.9%</span></span></td><td data-value='0.079433'><span class='chg'><span class='up'>+7.9%</span></span></td><td data-value='0.004485'><span class='chg'><span class='up'>+0.4%</span></span></td><td data-value='4062.357538'>4,062.36</td><td data-value='2985.000000'>2,985</td><td data-value='0.034802'><span class='chg'><span class='up'>+3.5%</span></span></td><td data-value='0.063034'><span class='chg'><span class='up'>+6.3%</span></span></td><td data-value='0.002351'><span class='chg'><span class='up'>+0.2%</span></span></td><td data-value='597000.000000'>597,000</td></tr><tr data-symbol='9432.T'><td style='text-align:left' data-value='9432.T'>9432.T <span class='co'>NTT INC</span></td><td data-value='2800.000000'>2,800</td><td data-value='13.152174'>13.2</td><td data-value='1.070367'>1.07</td><td data-value='0.040314'><span class='chg'><span class='up'>+4.0%</span></span></td><td data-value='0.046015'><span class='chg'><span class='up'>+4.6%</span></span></td><td data-value='-0.002941'><span class='chg'><span class='down'>-0.3%</span></span></td><td data-value='2997.026447'>2,997.03</td><td data-value='157.300003'>157</td><td data-value='0.046073'><span class='chg'><span class='up'>+4.6%</span></span></td><td data-value='0.030124'><span class='chg'><span class='up'>+3.0%</span></span></td><td data-value='-0.005060'><span class='chg'><span class='down'>-0.5%</span></span></td><td data-value='440440.008545'>440,440</td></tr><tr data-symbol='8316.T'><td style='text-align:left' data-value='8316.T'>8316.T <span class='co'>SUMITOMO MITSUI FINANCIAL GROUP</span></td><td data-value='100.000000'>100</td><td data-value='13.337930'>13.3</td><td data-value='27.647167'>27.65</td><td data-value='0.314750'><span class='chg'><span class='up'>+31.5%</span></span></td><td data-value='0.070214'><span class='chg'><span class='up'>+7.0%</span></span></td><td data-value='-0.001556'><span class='chg'><span class='down'>-0.2%</span></span></td><td data-value='2764.716697'>2,764.72</td><td data-value='4063.000000'>4,063</td><td data-value='0.322028'><span class='chg'><span class='up'>+32.2%</span></span></td><td data-value='0.053956'><span class='chg'><span class='up'>+5.4%</span></span></td><td data-value='-0.003678'><span class='chg'><span class='down'>-0.4%</span></span></td><td data-value='406300.000000'>406,300</td></tr><tr data-symbol='8591.T'><td style='text-align:left' data-value='8591.T'>8591.T <span class='co'>ORIX CORPORATION</span></td><td data-value='100.000000'>100</td><td data-value='11.740023'>11.7</td><td data-value='26.082105'>26.08</td><td data-value='0.084255'><span class='chg'><span class='up'>+8.4%</span></span></td><td data-value='0.144744'><span class='chg'><span class='up'>+14.5%</span></span></td><td data-value='0.010301'><span class='chg'><span class='up'>+1.0%</span></span></td><td data-value='2608.210460'>2,608.21</td><td data-value='3833.000000'>3,833</td><td data-value='0.090257'><span class='chg'><span class='up'>+9.0%</span></span></td><td data-value='0.127353'><span class='chg'><span class='up'>+12.7%</span></span></td><td data-value='0.008154'><span class='chg'><span class='up'>+0.8%</span></span></td><td data-value='383300.000000'>383,300</td></tr><tr data-symbol='3048.T'><td style='text-align:left' data-value='3048.T'>3048.T <span class='co'>BIC CAMERA INC.</span></td><td data-value='100.000000'>100</td><td data-value='15.087605'>15.1</td><td data-value='11.074517'>11.07</td><td data-value='0.009996'><span class='chg'><span class='up'>+1.0%</span></span></td><td data-value='0.057279'><span class='chg'><span class='up'>+5.7%</span></span></td><td data-value='0.002130'><span class='chg'><span class='up'>+0.2%</span></span></td><td data-value='1107.451741'>1,107.45</td><td data-value='1627.500000'>1,628</td><td data-value='0.015586'><span class='chg'><span class='up'>+1.6%</span></span></td><td data-value='0.041217'><span class='chg'><span class='up'>+4.1%</span></span></td><td data-value='0.000000'><span class='chg'><span class=''>0.0%</span></span></td><td data-value='162750.000000'>162,750</td></tr><tr data-symbol='7513.T'><td style='text-align:left' data-value='7513.T'>7513.T <span class='co'>KOJIMA CO LTD</span></td><td data-value='100.000000'>100</td><td data-value='18.754974'>18.8</td><td data-value='8.015841'>8.02</td><td data-value='0.210824'><span class='chg'><span class='up'>+21.1%</span></span></td><td data-value='0.007514'><span class='chg'><span class='up'>+0.8%</span></span></td><td data-value='-0.034743'><span class='chg'><span class='down'>-3.5%</span></span></td><td data-value='801.584117'>801.58</td><td data-value='1178.000000'>1,178</td><td data-value='0.217527'><span class='chg'><span class='up'>+21.8%</span></span></td><td data-value='-0.007791'><span class='chg'><span class='down'>-0.8%</span></span></td><td data-value='-0.036795'><span class='chg'><span class='down'>-3.7%</span></span></td><td data-value='117800.000000'>117,800</td></tr><tr data-symbol='6526.T'><td style='text-align:left' data-value='6526.T'>6526.T <span class='co'>SOCIONEXT INC</span></td><td data-value='0.000000'>0</td><td data-value='26.591932'>26.6</td><td data-value='19.692567'>19.69</td><td data-value='-0.091097'><span class='chg'><span class='down'>-9.1%</span></span></td><td data-value='0.011581'><span class='chg'><span class='up'>+1.2%</span></span></td><td data-value='0.025880'><span class='chg'><span class='up'>+2.6%</span></span></td><td data-value='0.000000'>0.00</td><td data-value='2894.000000'>2,894</td><td data-value='-0.086066'><span class='chg'><span class='down'>-8.6%</span></span></td><td data-value='-0.003787'><span class='chg'><span class='down'>-0.4%</span></span></td><td data-value='0.023700'><span class='chg'><span class='up'>+2.4%</span></span></td><td data-value='0.000000'>0</td></tr><tr data-symbol='7269.T'><td style='text-align:left' data-value='7269.T'>7269.T <span class='co'>SUZUKI MOTOR CORP</span></td><td data-value='0.000000'>0</td><td data-value='9.109884'>9.1</td><td data-value='13.364272'>13.36</td><td data-value='0.180459'><span class='chg'><span class='up'>+18.0%</span></span></td><td data-value='0.196698'><span class='chg'><span class='up'>+19.7%</span></span></td><td data-value='0.015312'><span class='chg'><span class='up'>+1.5%</span></span></td><td data-value='0.000000'>0.00</td><td data-value='1964.000000'>1,964</td><td data-value='0.186993'><span class='chg'><span class='up'>+18.7%</span></span></td><td data-value='0.178518'><span class='chg'><span class='up'>+17.9%</span></span></td><td data-value='0.013155'><span class='chg'><span class='up'>+1.3%</span></span></td><td data-value='0.000000'>0</td></tr></tbody>
          <tfoot>
            <tr><td style='text-align:left'>TOTAL</td><td></td><td></td><td></td><td></td><td></td><td></td><td>45,442.88</td><td></td><td></td><td></td><td></td><td>6,678,240</td></tr>
          </tfoot>
        </table>
        </div>
        <h3>米国株</h3>
        <div class='table-wrap'>
        <table id='pf-table-usd' class='pf-table'>
          <colgroup><col style='width:22%'/><col style='width:6%'/><col style='width:6%'/><col style='width:8%'/><col style='width:5%'/><col style='width:5%'/><col style='width:5%'/><col style='width:10%'/><col style='width:8%'/><col style='width:5%'/><col style='width:5%'/><col style='width:5%'/><col style='width:10%'/></colgroup>
          <thead>
            <tr>
              <th style='text-align:left'>SYMBOL<span class='sort-indicator'></span></th>
              <th>SHARES<span class='sort-indicator'></span></th>
              <th>PER<span class='sort-indicator'></span></th>
              <th>USD_PRICE<span class='sort-indicator'></span></th>
              <th>YoY<span class='sort-indicator'></span></th>
              <th>MoM<span class='sort-indicator'></span></th>
              <th>DoD<span class='sort-indicator'></span></th>
              <th>USD_VALUE<span class='sort-indicator'></span></th>
              <th>JPY_PRICE<span class='sort-indicator'></span></th>
              <th>YoY<span class='sort-indicator'></span></th>
              <th>MoM<span class='sort-indicator'></span></th>
              <th>DoD<span class='sort-indicator'></span></th>
              <th>JPY_VALUE<span class='sort-indicator'></span></th>
            </tr>
          </thead>
          <tbody>
            <tr data-symbol='TSM'><td style='text-align:left' data-value='TSM'>TSM <span class='co'>Taiwan Semiconductor Manufactur</span></td><td data-value='28.000000'>28</td><td data-value='26.180523'>26.2</td><td data-value='239.289993'>239.29</td><td data-value='0.413856'><span class='chg'><span class='up'>+41.4%</span></span></td><td data-value='-0.009643'><span class='chg'><span class='down'>-1.0%</span></span></td><td data-value='0.016093'><span class='chg'><span class='up'>+1.6%</span></span></td><td data-value='6700.119812'>6,700.12</td><td data-value='35165.818036'>35,166</td><td data-value='0.421682'><span class='chg'><span class='up'>+42.2%</span></span></td><td data-value='-0.024688'><span class='chg'><span class='down'>-2.5%</span></span></td><td data-value='0.013934'><span class='chg'><span class='up'>+1.4%</span></span></td><td data-value='984642.905000'>984,643</td></tr><tr data-symbol='NVDA'><td style='text-align:left' data-value='NVDA'>NVDA <span class='co'>NVIDIA Corporation</span></td><td data-value='28.000000'>28</td><td data-value='58.392290'>58.4</td><td data-value='181.600006'>181.60</td><td data-value='0.521801'><span class='chg'><span class='up'>+52.2%</span></span></td><td data-value='0.020970'><span class='chg'><span class='up'>+2.1%</span></span></td><td data-value='0.031994'><span class='chg'><span class='up'>+3.2%</span></span></td><td data-value='5084.800171'>5,084.80</td><td data-value='26687.755230'>26,688</td><td data-value='0.530225'><span class='chg'><span class='up'>+53.0%</span></span></td><td data-value='0.005460'><span class='chg'><span class='up'>+0.5%</span></span></td><td data-value='0.029801'><span class='chg'><span class='up'>+3.0%</span></span></td><td data-value='747257.146453'>747,257</td></tr><tr data-symbol='AVGO'><td style='text-align:left' data-value='AVGO'>AVGO <span class='co'>Broadcom Inc.</span></td><td data-value='13.000000'>13</td><td data-value='109.981680'>110.0</td><td data-value='300.250000'>300.25</td><td data-value='0.865076'><span class='chg'><span class='up'>+86.5%</span></span></td><td data-value='0.022302'><span class='chg'><span class='up'>+2.2%</span></span></td><td data-value='0.012648'><span class='chg'><span class='up'>+1.3%</span></span></td><td data-value='3903.250000'>3,903.25</td><td data-value='44124.439640'>44,124</td><td data-value='0.875400'><span class='chg'><span class='up'>+87.5%</span></span></td><td data-value='0.006771'><span class='chg'><span class='up'>+0.7%</span></span></td><td data-value='0.010495'><span class='chg'><span class='up'>+1.0%</span></span></td><td data-value='573617.715321'>573,618</td></tr><tr data-symbol='AMD'><td style='text-align:left' data-value='AMD'>AMD <span class='co'>Advanced Micro Devices, Inc.</span></td><td data-value='22.000000'>22</td><td data-value='100.077850'>100.1</td><td data-value='167.130005'>167.13</td><td data-value='0.125000'><span class='chg'><span class='up'>+12.5%</span></span></td><td data-value='-0.052067'><span class='chg'><span class='down'>-5.2%</span></span></td><td data-value='0.015062'><span class='chg'><span class='up'>+1.5%</span></span></td><td data-value='3676.860107'>3,676.86</td><td data-value='24561.258326'>24,561</td><td data-value='0.131227'><span class='chg'><span class='up'>+13.1%</span></span></td><td data-value='-0.066468'><span class='chg'><span class='down'>-6.6%</span></span></td><td data-value='0.012905'><span class='chg'><span class='up'>+1.3%</span></span></td><td data-value='540347.683180'>540,348</td></tr><tr data-symbol='MRVL'><td style='text-align:left' data-value='MRVL'>MRVL <span class='co'>Marvell Technology, Inc.</span></td><td data-value='33.000000'>33</td><td data-value='29.916000'>29.9</td><td data-value='74.790001'>74.79</td><td data-value='-0.015787'><span class='chg'><span class='down'>-1.6%</span></span></td><td data-value='-0.068667'><span class='chg'><span class='down'>-6.9%</span></span></td><td data-value='0.008087'><span class='chg'><span class='up'>+0.8%</span></span></td><td data-value='2468.070030'>2,468.07</td><td data-value='10991.063717'>10,991</td><td data-value='-0.010339'><span class='chg'><span class='down'>-1.0%</span></span></td><td data-value='-0.082816'><span class='chg'><span class='down'>-8.3%</span></span></td><td data-value='0.005945'><span class='chg'><span class='up'>+0.6%</span></span></td><td data-value='362705.102666'>362,705</td></tr><tr data-symbol='QCOM'><td style='text-align:left' data-value='QCOM'>QCOM <span class='co'>QUALCOMM Incorporated</span></td><td data-value='15.000000'>15</td><td data-value='15.436715'>15.4</td><td data-value='159.770004'>159.77</td><td data-value='-0.068561'><span class='chg'><span class='down'>-6.9%</span></span></td><td data-value='0.088648'><span class='chg'><span class='up'>+8.9%</span></span></td><td data-value='0.001695'><span class='chg'><span class='up'>+0.2%</span></span></td><td data-value='2396.550064'>2,396.55</td><td data-value='23479.639999'>23,480</td><td data-value='-0.063405'><span class='chg'><span class='down'>-6.3%</span></span></td><td data-value='0.072110'><span class='chg'><span class='up'>+7.2%</span></span></td><td data-value='-0.000434'><span class='chg'><span class='down'>-0.0%</span></span></td><td data-value='352194.599991'>352,195</td></tr><tr data-symbol='ARM'><td style='text-align:left' data-value='ARM'>ARM <span class='co'>Arm Holdings plc</span></td><td data-value='14.000000'>14</td><td data-value='213.121220'>213.1</td><td data-value='140.660004'>140.66</td><td data-value='0.058549'><span class='chg'><span class='up'>+5.9%</span></span></td><td data-value='-0.005057'><span class='chg'><span class='down'>-0.5%</span></span></td><td data-value='0.016341'><span class='chg'><span class='up'>+1.6%</span></span></td><td data-value='1969.240051'>1,969.24</td><td data-value='20671.253427'>20,671</td><td data-value='0.064409'><span class='chg'><span class='up'>+6.4%</span></span></td><td data-value='-0.020172'><span class='chg'><span class='down'>-2.0%</span></span></td><td data-value='0.014181'><span class='chg'><span class='up'>+1.4%</span></span></td><td data-value='289397.547973'>289,398</td></tr><tr data-symbol='MCD'><td style='text-align:left' data-value='MCD'>MCD <span class='co'>McDonald's Corporation</span></td><td data-value='5.000000'>5</td><td data-value='26.663527'>26.7</td><td data-value='311.429993'>311.43</td><td data-value='0.104218'><span class='chg'><span class='up'>+10.4%</span></span></td><td data-value='0.037858'><span class='chg'><span class='up'>+3.8%</span></span></td><td data-value='-0.001763'><span class='chg'><span class='down'>-0.2%</span></span></td><td data-value='1557.149963'>1,557.15</td><td data-value='45767.440180'>45,767</td><td data-value='0.110330'><span class='chg'><span class='up'>+11.0%</span></span></td><td data-value='0.022091'><span class='chg'><span class='up'>+2.2%</span></span></td><td data-value='-0.003885'><span class='chg'><span class='down'>-0.4%</span></span></td><td data-value='228837.200898'>228,837</td></tr><tr data-symbol='CDNS'><td style='text-align:left' data-value='CDNS'>CDNS <span class='co'>Cadence Design Systems, Inc.</span></td><td data-value='4.000000'>4</td><td data-value='93.498650'>93.5</td><td data-value='346.880005'>346.88</td><td data-value='0.289852'><span class='chg'><span class='up'>+29.0%</span></span></td><td data-value='-0.048523'><span class='chg'><span class='down'>-4.9%</span></span></td><td data-value='-0.008603'><span class='chg'><span class='down'>-0.9%</span></span></td><td data-value='1387.520020'>1,387.52</td><td data-value='50977.138511'>50,977</td><td data-value='0.296992'><span class='chg'><span class='up'>+29.7%</span></span></td><td data-value='-0.062977'><span class='chg'><span class='down'>-6.3%</span></span></td><td data-value='-0.010710'><span class='chg'><span class='down'>-1.1%</span></span></td><td data-value='203908.554042'>203,909</td></tr><tr data-symbol='SBUX'><td style='text-align:left' data-value='SBUX'>SBUX <span class='co'>Starbucks Corporation</span></td><td data-value='15.000000'>15</td><td data-value='37.948055'>37.9</td><td data-value='87.660004'>87.66</td><td data-value='-0.043695'><span class='chg'><span class='down'>-4.4%</span></span></td><td data-value='-0.010337'><span class='chg'><span class='down'>-1.0%</span></span></td><td data-value='-0.001128'><span class='chg'><span class='down'>-0.1%</span></span></td><td data-value='1314.900055'>1,314.90</td><td data-value='12882.426446'>12,882</td><td data-value='-0.038401'><span class='chg'><span class='down'>-3.8%</span></span></td><td data-value='-0.025371'><span class='chg'><span class='down'>-2.5%</span></span></td><td data-value='-0.003251'><span class='chg'><span class='down'>-0.3%</span></span></td><td data-value='193236.396691'>193,236</td></tr><tr data-symbol='SNPS'><td style='text-align:left' data-value='SNPS'>SNPS <span class='co'>Synopsys, Inc.</span></td><td data-value='2.000000'>2</td><td data-value='69.892235'>69.9</td><td data-value='603.169983'>603.17</td><td data-value='0.160880'><span class='chg'><span class='up'>+16.1%</span></span></td><td data-value='-0.047832'><span class='chg'><span class='down'>-4.8%</span></span></td><td data-value='0.002010'><span class='chg'><span class='up'>+0.2%</span></span></td><td data-value='1206.339966'>1,206.34</td><td data-value='88641.257298'>88,641</td><td data-value='0.167306'><span class='chg'><span class='up'>+16.7%</span></span></td><td data-value='-0.062297'><span class='chg'><span class='down'>-6.2%</span></span></td><td data-value='-0.000120'><span class='chg'><span class='down'>-0.0%</span></span></td><td data-value='177282.514595'>177,283</td></tr><tr data-symbol='INTC'><td style='text-align:left' data-value='INTC'>INTC <span class='co'>Intel Corporation</span></td><td data-value='0.000000'>0</td><td data-value='25.618557'>25.6</td><td data-value='24.850000'>24.85</td><td data-value='0.134648'><span class='chg'><span class='up'>+13.5%</span></span></td><td data-value='0.255051'><span class='chg'><span class='up'>+25.5%</span></span></td><td data-value='0.003838'><span class='chg'><span class='up'>+0.4%</span></span></td><td data-value='0.000000'>0.00</td><td data-value='3651.931197'>3,652</td><td data-value='0.140929'><span class='chg'><span class='up'>+14.1%</span></span></td><td data-value='0.235984'><span class='chg'><span class='up'>+23.6%</span></span></td><td data-value='0.001704'><span class='chg'><span class='up'>+0.2%</span></span></td><td data-value='0.000000'>0</td></tr>
          </tbody>
          <tfoot>
            <tr><td style='text-align:left'>TOTAL</td><td></td><td></td><td></td><td></td><td></td><td></td><td>31,664.80</td><td></td><td></td><td></td><td></td><td>4,653,427</td></tr>
          </tfoot>
        </table>
        </div>
        <h3>全体合計</h3>
        <div class='table-wrap'>
        <table id='pf-total' class='pf-table pf-total'>
          <colgroup><col style='width:22%'/><col style='width:6%'/><col style='width:6%'/><col style='width:8%'/><col style='width:5%'/><col style='width:5%'/><col style='width:5%'/><col style='width:10%'/><col style='width:8%'/><col style='width:5%'/><col style='width:5%'/><col style='width:5%'/><col style='width:10%'/></colgroup>
          <thead>
            <tr>
              <th style='text-align:left'>TYPE<span class='sort-indicator'></span></th>
              <th>SHARES<span class='sort-indicator'></span></th>
              <th>PER<span class='sort-indicator'></span></th>
              <th>USD_PRICE<span class='sort-indicator'></span></th>
              <th>YoY<span class='sort-indicator'></span></th>
              <th>MoM<span class='sort-indicator'></span></th>
              <th>DoD<span class='sort-indicator'></span></th>
              <th>USD_VALUE<span class='sort-indicator'></span></th>
              <th>JPY_PRICE<span class='sort-indicator'></span></th>
              <th>YoY<span class='sort-indicator'></span></th>
              <th>MoM<span class='sort-indicator'></span></th>
              <th>DoD<span class='sort-indicator'></span></th>
              <th>JPY_VALUE<span class='sort-indicator'></span></th>
            </tr>
          </thead>
          <tfoot>
            <tr><td style='text-align:left'>OVERALL TOTAL</td><td></td><td></td><td></td><td></td><td></td><td></td><td>77,107.68</td><td></td><td></td><td></td><td></td><td>11,331,667</td></tr>
          </tfoot>
        </table>
        </div>
        <p id='fx-rate' class='muted'>為替: USD→JPY = 146.9590</p>
      </body>
    </html>
    
